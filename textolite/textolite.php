<?php /* Textolite v2.10e */ ini_set('error_reporting',E_ALL);ini_set('display_errors',0);ini_set('log_errors',1);ini_set('error_log','error.log');version_compare(PHP_VERSION,'5.2','>=')||exit('PHP '.PHP_VERSION.' is not supported');define('a_','document_root');define('b_','query_string');define('c_','request_uri');define('d_','php_self');define('e_','http_accept_language');define('f_','http_user_agent');define('g_','remote_addr');define('h_','server_addr');define('i_','script_filename');define('j_','script_name');define('k_','server_name');define('l_','server_protocol');define('m_','lang');define('n_','password');define('o_','session');define('p_','pass_complexity');define('q_','pass_complexity_js');define('r_','auth_time');define('s_','auth_error_time');define('t_','auth_error_list');define('u_','auth_error_limit');define('v_','auth_lockout_duration');define('w_','auth_session_reset');define('x_','auth_bot_filter');define('y_','code_redraw_delay');define('z_','code_undo_limit');define('A_','code_highlighting');define('B_','allowed_ext');define('C_','editable_ext');define('D_','default_file');define('E_','document_root');define('F_','mod_rewrite');define('G_','logout_to_site');define('H_','link_replacing');define('I_','image_rewriting');define('J_','recovery_points');define('K_','site_scripts');define('L_','site_styles');define('M_','update_final');define('N_','update_beta');define('O_','filelist');define('P_','system_url');define('Q_','error_limit');define('R_','error_count');define('S_','redraw_delay');define('T_','mode');define('U_','type');define('V_','base');define('W_','code');define('X_','title');define('Y_','version');define('Z_','is_edited');define('_a','post_max_size');define('_b','upload_max_filesize');define('_c','max_file_uploads');define('_d','_checkbox');define('_e','logout_to_site'._d);define('_f','site_scripts'._d);define('_g','site_styles'._d);define('_h','link_replacing'._d);define('_i','image_rewriting'._d);define('_j','code_highlighting'._d);define('_k','update_final'._d);define('_l','update_beta'._d);define('_m','http_ajax');define('_n','source');define('_o','token');define('_p','sha1');define('_q','html');define('_r','xml');define('_s','php');define('_t','404');define('_u','403');define('_v','ip');define('_w','sip');define('_x','url');define('_y','name');define('_z','date');define('_A','size');define('_B','list');define('_C','file');define('_D','error');define('_E','value');define('_F','radio');define('_G','tmp_name');define('_H','langlist');define('_I','<script');define('_J','<_cript');define('_K','</script');define('_L','</_cript');define('_M','</body>');define('_N','<!--~~?');define('_O','?~~-->');define('__','textolite_');final class a{private $a;private $b;public function __construct(){$this->a['a']=$_GET;$this->a['b']=$_POST;$this->a['c']=$_SERVER;$this->a['d']=$_COOKIE;$this->a['e']=$_FILES;}public function a(){if(isset($this->a['a']['q']))return $this->a['a']['q'];}public function b($a=false,$b=false){if(isset($this->b['c'][$a]))return $this->b['c'][$a];else{$c=strtoupper($a);if(isset($this->a['c'][$c])){if(!$b)$b=$a;return $this->b['c'][$a]=$this->g($this->a['c'][$c],$b);}}}public function c($a=false,$b=false){if($a){if(isset($this->b['b'][$a]))return $this->b['b'][$a];else if(isset($this->a['b'][$a]))return $this->b['b'][$a]=$this->g($this->a['b'][$a],$b);}else if(count($this->a['b']))return true;}public function d($a,$b=false){if(isset($this->b['d'][$a]))return $this->b['d'][$a];else if(isset($this->a['d'][$a]))return $this->b['d'][$a]=$this->g($this->a['d'][$a],$b);}public function e($a){if(isset($this->a['e'][$a]))return $this->a['e'][$a];}public function f(){if((stripos($this->b(b_),'q=')===0)&&(stripos($this->b(c_),$this->b(b_))===false))return 1;else return 0;}private function g($a,$b){if($b&&($c='_'.$b)&&method_exists($this,$c))return $this->$c($a);else return $a;}private function _server_protocol($a){preg_match('~^[a-z]{4,5}/[0-9]\.[0-9]$~i',$a,$b);if(isset($b[0]))return $b[0];}private function _server_name($a){preg_match('~^[a-z0-9-_\.]{2,300}$~i',$a,$b);if(isset($b[0]))return $b[0];}private function _script_filename($a){$b=str_replace('\\','/',__FILE__);if(stripos($b,$this->a['c'][strtoupper(a_)])===0)return $b;else return str_replace('\\','/',$a);}private function _document_root($a){$a=str_replace('\\','/',$a);$b=$this->b(i_);$c=$this->b(d_);$d=$this->b(j_);if(__LINE__!=1)exit;if(stripos($b,$c)>0)$e=str_ireplace($c,'',$b);if(stripos($b,$d)>0)$f=str_ireplace($d,'',$b);if(isset($e)){if(isset($f)){if(strlen($e)>strlen($f))$g=$e;else$g=$f;}else$g=$e;}else if(isset($f))$g=$f;else$g=$a;if(stripos($b,$a)===0){if(strlen($g)>strlen($a))$a=$g;}else$a=$g;if(substr($a,-1)=='/')return substr($a,0,-1);return $a;}private function _php_self($a){return str_replace('\\','/',$a);}private function _script_name($a){return str_replace('\\','/',$a);}private function _query_string($a){return str_replace('\\','/',$a);}private function _http_accept_language($a){preg_match('~[a-z]{2}~i',strtolower(substr($a,0,2)),$b);if(isset($b[0]))return $b[0];}private function _remote_addr($a){return $this->_ip($a);}private function _server_addr($a){return $this->_ip($a);}private function _ip($a){preg_match('~^[a-z0-9.:]{1,40}$~i',$a,$b);if(isset($b[0]))return $b[0];}private function _sha1($a){preg_match('~^[a-z0-9]{40}$~i',$a,$b);if(isset($b[0]))return $b[0];}}final class b{private $a;private $b;private $c;private $d;public function __construct($a){$this->a=$a;$this->a('Content-type:text/html;charset=utf-8');}public function a($a){return $this->b[]=$a;}public function b($a,$b){return $this->b[]=$this->a.' '.$a.' '.$b;}public function c($a){return $this->b[]='Location:'.$a;}public function d($a,$b=false,$c=false,$d=false,$e=false,$f=false,$g=false){$h['a']=$a;$h['b']=$b;$h['c']=$g;$h['d']=(int)$c;$h['e']=$d;$h['f']=$e;$h['g']=(int)$f;$this->c[]=$h;}public function e($a,$b=false,$c=false){$this->d($a,'',time()-60*60,$b,$c);}public function f($a){return $this->d=$a;}public function g(){if(isset($this->b))foreach($this->b as $a)header($a);if(isset($this->c))foreach($this->c as $b)setcookie($b['a'],$b['b'],$b['d'],$b['e'],$b['f'],$b['g'],$b['c']);if(isset($this->d))print $this->d;if(__LINE__!=1)exit;}}final class c{const a="\n";const b='lang.ini';const c='conf.ini';private $a;private $b;private $c;private $d;private $e;private $f;private $g;public function __construct($a,$b,$c,$d,$e){$this->c=parse_ini_file($a.self::b,true);$this->d=parse_ini_file($a.self::c,true);$this->e=array('c'=>'<ol><li title="{source_editor}">{type}</li><li title="{visual_editor}">text</li></ol>','d'=>'<ol><li>{type}</li></ol>','j'=>'<div id="e"><div><div><h1><a href="//textolite.ru/">Textolite</a> v{version}</h1><p>{extended}</p></div>{mode}<ul><li><a title="{files}">{files}</a><div id="f"><ol><li>{file_name}</li><li>{file_size}</li><li>{file_changed}</li><li>{file_menu}</li></ol><ul>{filelist}</ul></div></li><li><a title="{settings}">{settings}</a><div id="g"><fieldset><legend>{auth}</legend><dl><dt title="{new_password}">{new_password}:</dt><dd><input type="password" maxlength="14"><a></a></dd><dt title="{auth_error_limit_desc}">{login_attempts}:</dt><dd data-aa="5"><input type="text" maxlength="2" value="{auth_error_limit}"></dd><dt title="{auth_lockout_duration_desc}">{lockout_duration}:</dt><dd data-aa="1"><input type="text" maxlength="7" value="{auth_lockout_duration}"></dd><dt title="{auth_session_reset_desc}">{session_autoreset}:</dt><dd data-aa="30"><input type="text" maxlength="7" value="{auth_session_reset}"></dd><dd title="{logout_to_site_desc}" data-aa="0"><label>{logout_to_site_checkbox}<em></em>{redirect_to_site}</label></dd></dl></fieldset><fieldset><legend>{visual_editor}</legend><dl><dd title="{site_scripts_desc}" data-aa="1"><label>{site_scripts_checkbox}<em></em>{enable_scripts}</label></dd><dd title="{site_styles_desc}" data-aa="1"><label>{site_styles_checkbox}<em></em>{enable_styles}</label></dd><dd title="{link_replacing_desc}" data-aa="1"><label>{link_replacing_checkbox}<em></em>{change_links}</label></dd><dd title="{image_rewriting_desc}" data-aa="0"><label>{image_rewriting_checkbox}<em></em>{rewrite_file}</label></dd></dl></fieldset><fieldset><legend>{source_editor}</legend><dl><dt title="{code_redraw_delay_desc}">{redraw_delay}:</dt><dd data-aa="200"><input type="text" maxlength="7" value="{code_redraw_delay}"></dd><dt title="{code_undo_limit_desc}">{steps_for_undo}:</dt><dd data-aa="50"><input type="text" maxlength="3" value="{code_undo_limit}"></dd><dd title="{code_highlighting_desc}" data-aa="1"><label>{code_highlighting_checkbox}<em></em>{enable_highlighting}</label></dd></dl></fieldset><fieldset><legend>{system}</legend><dl><dt title="{default_file_desc}">{main_page_or_file}:</dt><dd data-aa="index.html"><input type="text" maxlength="30" value="{default_file}"></dd><dt title="{recovery_points_desc}">{number_of_recovery_point}:</dt><dd data-aa="5"><input type="text" maxlength="2" value="{recovery_points}"></dd><dd title="{new_version_notify}" data-aa="1"><label>{update_final_checkbox}<em></em>{new_version_notify}</label></dd><dd title="{beta_version_notify}" data-aa="0"><label>{update_beta_checkbox}<em></em>{beta_version_notify}</label></dd><dt title="{language}">{language}:</dt><dd data-aa="index.html"><ul>{langlist}</ul></dd></dl></fieldset><p><input type="button" value="{save}" disabled><a title="{restore_settings}"></a></p></div></li></ul><div><ul data-ab="<li>{tagname}<i><i></i></i></li>"></ul><p><i title="{clone_block}"></i><i title="{move_up_block}"></i><i title="{move_down_block}"></i><i title="{delete_block}"></i></p></div><ul><li><input type="button" value="{save}" title="{save}" disabled></li><li><input type="button" value="{logout}" title="{logout}" disabled data-ac="{not_save}"></li></ul><p><samp data-ad="{saving}" data-ae="{saved}" data-af="{not_saved}" data-ag="{reset_session}" data-ah="{access_closed}" data-ai="{request_rejected}" data-aj="{request_blocked}" data-ak="{no_response}" data-al="{not_writable}" data-am="{old_browser}" data-an="{new_version}" data-ao="{need_update}" data-ap="{install}" data-aq="{not_install}" data-ar="{download_installer}" data-as="{system_update}" data-at="{update_error}" data-au="{install_complete}" data-av="{activation_complete}" data-aw="{attachment_domain}" data-ax="{no_connect}" data-ay="{password_hashing}" data-az="{pass_complexity}" data-bb="{uploading}" data-bc="{uploading_complete}" data-bd="{uploading_error}" data-be="{extension_error}" data-bf="{count_limit}" data-bg="{size_limit}" data-bh="{file_deletion}" data-bi="{file_deleted}" data-bj="{deletion_error}" data-bk="{file_recovery}" data-bl="{recovery_success}" data-bm="{recovery_error}" data-bn="{backup_error}" data-bo="{file_replacing}" data-bp="{incorrect_link}" data-bq="{unknown_relation}" data-br="{element_busy}" data-bs="{disable_script}" data-bt="{disable}" data-bu="{disabling_scripts}" data-bv="{scripts_disabled}" data-bw="{show_password}" data-bx="{hide_password}" data-by="{post_max_size}" data-bz="{upload_max_filesize}" data-bA="{max_file_uploads}" data-cc="{auth_session_reset}" data-cd="{link_replacing}" data-ce="{site_scripts}" data-cf="{site_styles}" data-cg="{logout_to_site}" data-ch="{ip}" data-ci="{sip}" data-cj="{system_url}" data-ck="{is_edited}" data-cl="{version}" data-cm="{update_final}" data-cn="{update_beta}"></samp><noscript><samp>{requires_javascript}</samp></noscript><i></i></p></div></div><script src="{system_url}textolite.js?v={version}"></script><script type="text/template" id="h">{source}</script>','a'=>'<!doctype html><html id="a"><head><title>{auth} - Textolite</title><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="{system_url}textolite.css?v={version}"></head><body><fieldset><legend>{auth}</legend><ol data-co="{error_limit}" data-cp="{error_count}"><li></li></ol><p><samp data-ay="{password_hashing}" data-cq="{password_checking}" data-cr="{access_granted}" data-cs="{access_denied}" data-ak="{no_response}" data-al="{not_writable}" data-cj="{system_url}">{document_root_error}</samp><noscript><samp>{requires_javascript}</samp></noscript><i></i></p><p><span>{password}:</span><input type="password" data-az="{pass_complexity}" maxlength="14"><a data-bw="{show_password}" data-bx="{hide_password}"></a></p><p><input type="button" value="{login}" disabled></p></fieldset><script src="{system_url}textolite.js?v={version}"></script></body></html>','g'=>'<!doctype html><html id="b"><head><title>{code} - {{code}} - Textolite</title><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="{system_url}textolite.css?v={version}"></head><body><samp><span>{code}</span>{{code}}</samp></body></html>','f'=>'<!doctype html><html id="d"><head><title>{title} - Textolite</title><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="{system_url}textolite.css?v={version}"></head><body><iframe>{no_frames}</iframe><script type="text/template" id="i"><base href="{base}"></script><script type="text/template" id="j"><edit class="textolite-block" contenteditable></edit></script><script type="text/template" id="k">@keyframes drop{0%{opacity:0.6;}49%{opacity:0.6;}50%{opacity:1;}99%{opacity:1;}}.textolite-block{outline:none;font-style:inherit;cursor:text}.textolite-focus{outline:4px solid #f2ca00 !important;outline-offset:8px}.textolite-disabled{outline-color:#f00 !important}.textolite-dragover{outline:4px solid #adc8fe;outline-offset:-4px}.textolite-drop{animation:drop 70ms infinite linear}.textolite-iframe{display:block;position:absolute}</script></body></html>','e'=>'<!doctype html><html id="c"><head><title>{title} - Textolite</title><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="stylesheet" href="{system_url}textolite.css?v={version}"></head><body><div><ol data-ab="<li style=height:0px></li>"></ol><pre contenteditable data-ct="{redraw_delay}" data-cu="{code_highlighting}" data-cv="{code_undo_limit}"></pre></div></body></html>','l'=>'<li><ol class="u"><li><a data-cw="{url}">{name}</a></li><li>{size}</li><li>{date}</li><li><i title="{recover_backup}"></i><i title="{recovery_confirm}"></i><i title="{recovery_cancel}"></i></li></ol><ul>{list}</ul></li>','k'=>'<li><ol class="s"><li><a data-cw="{url}">{name}</a></li><li>{size}</li><li>{date}</li><li><i title="{add_file}"></i></li></ol><ul></ul></li>','b'=>'<li><ol class="v"><li><a data-cw="{url}">{name}</a></li><li>{size}</li><li>{date}</li><li><i title="{delete_file}"></i><i title="{deletion_confirm}"></i><i title="{deletion_cancel}"></i></li></ol></li>','o'=>'<li title="{{lang}}">{radio}{lang}</li>','n'=>'<input type="radio" name="{name}" value="{value}">','m'=>'<input type="radio" name="{name}" value="{value}" checked>','i'=>'<input type="checkbox">','h'=>'<input type="checkbox" checked>');$this->a['a']=$a;$this->a['b']=$this->i(a_);if(!$this->a['b'])$this->a['b']=$b;$this->a['c']=str_ireplace($this->a['b'],'',$this->a['a']);$this->a['d']=$this->q($a);$this->a['e']=$this->q($this->a['c']);if(stripos($f=$this->i(m_),',')){if($d&&stripos($f,$d)!==false)$this->b=$d;else if(stripos($f,$c)!==false)$this->b=$c;else$this->b=substr($f,0,2);}else$this->b=substr($f,0,2);if(__LINE__!=1)exit;if($this->i(F_)==='1')$this->g=1;else if($this->i(F_)==='0')$this->g=0;else$this->g=$e;}public function __destruct(){if($this->f)$this->k();}public function a(){return $this->b;}public function b($a=false){if($a&&!$this->g)return $this->a['c'].'?q=';else return $this->a['c'];}public function c(){return $this->a['a'];}public function d(){return $this->a['e'];}public function e(){return $this->a['d'];}public function f(){return $this->a['b'];}public function g(){return $this->a['a'].'backup/';}public function h(){return $this->a['c'].'backup/';}public function i($a,$b=false){if($b){if(isset($this->d[$b][$a]))return $this->d[$b][$a];}else if(isset($this->d[$a]))return $this->d[$a];}public function j($a,$b,$c=false){if($c){if(isset($this->d[$c])){$this->f=true;return $this->d[$c][$a]=$b;}}else{$this->f=true;return $this->d[$a]=$b;}}private function k(){foreach($this->d as $a=>$b)if(!is_array($b))$c[]=$a.' = '.$b.self::a.self::a;foreach($this->d as $a=>$b){if(is_array($b)){$c[]='['.$a.']'.self::a.self::a;foreach($b as $d=>$e)$c[]="\t".$d.' = '.$e.self::a;$c[]=self::a;}}if($f=fopen($this->a['a'].self::c,'w')){flock($f,LOCK_EX);fwrite($f,implode('',$c));flock($f,LOCK_UN);fclose($f);}}public function l($a,$b=false){if(isset($this->e[$a]))return $this->n($this->m($this->e[$a],$b));}public function m($a,$b){if($b)foreach($b as $c=>$d)$a=str_ireplace('{'.$c.'}',$d,$a);return $a;}public function n($a){preg_match_all('~\{([a-z0-9_]{2,30})\}~i',$a,$b);if($b[1]){$b[1]=array_unique($b[1]);foreach($b[1] as $c)if($d=$this->o($c))$a=str_ireplace('{'.$c.'}',$d,$a);}return $a;}public function o($a){if(isset($this->c[$this->b][$a]))return $this->c[$this->b][$a];}public function p($a){if(isset($this->c['en'][$a]))return $this->c['en'][$a];}public function q($a){if(substr_count($a,'/')>2)return dirname($a).'/';else return '/';}public function r(){return is_writable($this->a['a'].self::c);}}final class d{const a='2.10e';private $a;private $b;private $c;public function __construct($a,$b,$c){$this->a=$a;$this->b=$b;$this->c=$c;}public function a(){$a=$this->b->d(__.o_,_p);if($a&&$a==$this->a->i(o_))$this->b();else{$b=unserialize(urldecode($this->a->i(t_)));$c=$this->a->i(u_);$d=$this->b->b(g_);if($b&&isset($b[$d]))$e=$b[$d];else$e=0;$f=time();if($this->b->c()&&$this->b->b(_m)){$g=$this->b->c(n_,_p);if($g&&($e<$c||$this->a->i(s_)+($this->a->i(v_)*60)<$f)){$h=$this->a->i(n_);$i=$this->a->i(q_)*1;$j=$this->a->i(p_)*1;$k=$j-$i;for($l=0;$l<$k;$l++)$g=sha1($g);if($h==$g){if($this->a->r()){$this->t();if(isset($b[$d])){unset($b[$d]);$this->a->j(t_,urlencode(serialize($b)));}if($i<5)$this->a->j(q_,15000);else$this->a->j(q_,$i-1);$this->a->j(r_,$f);$this->a->j(O_,'');}else{$this->c->a('X-a:1');$this->c->b(404,$this->a->p(_t));}}else{$this->a->j(s_,$f);$b[$d]=$e+1;$this->a->j(t_,urlencode(serialize($b)));$this->c->b(404,$this->a->p(_t));}}else$this->c->b(404,$this->a->p(_t));}else{if(!$this->a->i(x_)||$this->b->b(e_)&&$this->b->b(f_)&&preg_match('~Chrome|Firefox|Opera|Safari|AppleWebKit|Trident|MSIE~i',$this->b->b(f_))){if($e<$c||$this->a->i(s_)+($this->a->i(v_)*60)<$f){$m[P_]=$this->a->b();$m[Q_]=$c;$m[R_]=$e;$m[p_]=$this->a->i(q_);$m[Y_]=self::a;$this->c->f($this->a->l('a',$m));}else throw new Exception(false,403);}else throw new Exception(false,403);}}}public function b(){$aa=$this->b->a();if(!$aa||!preg_match('~\.[a-z]{2,5}$~i',$aa)){if($this->b->b(i_)!=str_replace('\\','/',__FILE__))$this->q();if(!file_exists($this->a->e().$this->a->i(D_))&&($ab=$this->p()))throw new Exception($this->a->b(1).$ab,307);else throw new Exception($this->a->b(1).$this->a->i(D_),307);}$ac=$this->a->e().$aa;if($this->b->b(_m)){if($this->b->c('reload'))$this->t();else if($this->b->c('logout'))$this->u();else if(($ad=$this->b->c('save'))&&($ae=$this->b->c(_o,_p))&&($ae==$this->b->d(__._o,_p))){$this->c->e(__._o);$ad=str_replace(_L,_K,base64_decode(str_replace('_','a',$ad)));$ad=str_replace(_J,_I,$ad);$ad=str_replace(_N,'<?',$ad);$ad=str_replace(_O,'?>',$ad);if($this->f(strtolower(substr($ac,strripos($ac,'.')+1)))){if($this->g($aa)){if(is_writable($ac)&&$af=fopen($ac,'w')){flock($af,LOCK_EX);fwrite($af,$ad);flock($af,LOCK_UN);fclose($af);$this->a->j(O_,'');}else{$this->c->a('X-a:1');$this->c->b(404,$this->a->p(_t));}}else{$this->c->a('X-b:1');$this->c->b(404,$this->a->p(_t));}}else$this->c->b(404,$this->a->p(_t));}else if($ag=$this->b->c('open')){$ag=rawurldecode($ag);$ah=$this->i($ag);if($ah===false){$this->a->j(O_,'');$ah=$this->i($ag);}if($ah!==false)$this->c->f($ah);else$this->c->b(404,$this->a->p(_t));}else if(($ag=$this->b->c('upload'))&&($ae=$this->b->c(_o,_p))&&($ae==$this->b->d(__._o,_p))){$this->c->e(__._o);$ag=rawurldecode($ag);$ai=$this->a->f().$ag;$aj=$this->b->e(_C);if($ak=count($aj)&&is_dir($ai)){$al='';$am=$this->a->l('b');$an=str_replace(' ','',str_replace(',','|',$this->a->i(C_)));foreach($aj[_G] as $ao=>$ap){if($this->f(strtolower(substr($aj[_y][$ao],strripos($aj[_y][$ao],'.')+1)))){if(!$aj[_D][$ao]){$ac=$ai.$aj[_y][$ao];if($this->g(substr($ag.$aj[_y][$ao],strlen($this->a->d())))){move_uploaded_file($ap,$ac);$aq[_y]=$aj[_y][$ao];$aq[_z]=filemtime($ac);$aq[_A]=filesize($ac);preg_match('~\.(?:'.$an.')$~i',$aq[_y],$ar);if(isset($ar[0]))$aq[_x]=$this->a->b(1).substr($ag,strlen($this->a->d())).$aq[_y];else$aq[_x]=$ag.$aq[_y];$al.=$this->a->m($am,$aq);}else$as=true;}else$at=true;}else$au=true;if(isset($al)){$this->a->j(O_,'');$av=$this->l($ag);$aw=$av[_A];$this->c->a('X-c:'.$aw);$this->c->f($al);}if(isset($au))$this->c->a('X-d:1');else if(isset($as))$this->c->a('X-b:1');else if(isset($at))$this->c->a('X-e:1');}}else$this->c->b(404,$this->a->p(_t));}else if(($ax=$this->b->c('remove'))&&($ae=$this->b->c(_o,_p))&&($ae==$this->b->d(__._o,_p))){$this->c->e(__._o);$ax=rawurldecode($ax);if($this->f(strtolower(substr($ax,strripos($ax,'.')+1)))){$ax=str_replace($this->a->b(),$this->a->d(),$ax);$ac=$this->a->f().$ax;if($this->g(substr($ax,strlen($this->a->d())))){if(is_file($ac)&&unlink($ac)){$this->a->j(O_,'');$ay=$this->l($this->a->q($ax));$this->c->a('X-c:'.$ay[_A]);}else$this->c->b(404,$this->a->p(_t));}else{$this->c->a('X-b:1');$this->c->b(404,$this->a->p(_t));}}else{$this->c->a('X-d:1');$this->c->b(404,$this->a->p(_t));}}else if(($ax=$this->b->c('replace'))&&($ae=$this->b->c(_o,_p))&&($ae==$this->b->d(__._o,_p))){$this->c->e(__._o);$ax=rawurldecode($ax);$az=$this->b->e(_C);if(isset($az[_G])&&$az[_D]<1){if($this->f(strtolower(substr($az[_y],strripos($az[_y],'.')+1)))){if(stripos($ax,$this->b->b(k_).$this->a->d())){$aA=explode($this->b->b(k_).$this->a->d(),$ax);if(isset($aA[1])&&file_exists($this->a->e().$aA[1])){if($this->g($aA[1])){$aB=dirname($this->a->e().$aA[1]).'/';$aC=$this->e($aB,$az[_y]);move_uploaded_file($az[_G],$aC);$this->a->j(O_,'');$this->c->f(dirname($ax).'/'.basename($aC));}else{$this->c->a('X-b:1');$this->c->b(404,$this->a->p(_t));}}else$this->c->b(404,$this->a->p(_t));}else{$aC=$this->e($this->a->e(),$az[_y]);move_uploaded_file($az[_G],$aC);$this->a->j(O_,'');$this->c->f($this->a->d().$az[_y]);}}else{$this->c->a('X-d:1');$this->c->b(404,$this->a->p(_t));}}else$this->c->b(404,$this->a->p(_t));}else if(($aD=$this->b->c('settings'))&&($ae=$this->b->c(_o,_p))&&($ae==$this->b->d(__._o,_p))){$this->c->e(__._o);if($aD[n_]){$aE=$this->a->i(n_);$aF=$this->a->i(p_)-$this->a->i(q_);for($aG=0;$aG<$aF;$aG++)$aD[n_]=sha1($aD[n_]);if($aD[n_]!=$aE)$this->a->j(n_,$aD[n_]);}if($aD[m_]&&$aD[m_]!=$this->a->a()){if(stripos($aH=$this->a->i(m_),',')&&stripos($aH,$aD[m_])!==false){if($aD[m_]!=$this->b->b(e_))$this->c->d(__.m_,$aD[m_],time()+60*60*24*365,$this->a->b(),false,false,true);else$this->c->e(__.m_,$this->a->b());}else$this->c->b(404,$this->a->p(_t));}if($this->a->i(D_)!==null&&preg_match('~^.{1,30}$~i',$aD[D_],$ar)&&isset($ar[0]))$this->a->j(D_,$aD[D_]);else$this->c->b(404,$this->a->p(_t));unset($aD[n_],$aD[m_],$aD[D_]);foreach($aD as $ao=>$aI){if($this->a->i($ao)!==null&&preg_match('~^[0-9]{1,7}$~i',$aI,$ar)&&isset($ar[0]))$this->a->j($ao,$aI);else$this->c->b(404,$this->a->p(_t));}}else if(($ag=$this->b->c('recovery'))&&($ae=$this->b->c(_o,_p))&&($ae==$this->b->d(__._o,_p))){$this->c->e(__._o);$ag=rawurldecode($ag);$ai=$this->a->f().$ag;if(is_dir($ai)&&is_writable($this->a->g())&&$aJ=opendir($ai)){while(($aK=readdir($aJ))!==false){if($aK!='.'&&$aK!='..'&&is_file($ai.$aK)){$aK=str_ireplace('ꜜ','[~]',$aK);if(substr($aK,0,3)=='[~]'){$ac=$this->a->e().str_ireplace('⁄','/',substr($aK,3));if(file_exists($ac))if(!unlink($ac))$aL=true;}else{$ac=$this->a->e().str_ireplace('⁄','/',$aK);if(!copy($ai.$aK,$ac))$aL=true;}if(!unlink($ai.str_ireplace('[~]','ꜜ',$aK)))$aL=true;}}closedir($aJ);$this->a->j(O_,'');if(!isset($aL)){if(!rmdir($ai))$this->c->b(404,$this->a->p(_t));}else$this->c->b(404,$this->a->p(_t));}else$this->c->b(404,$this->a->p(_t));}else if(($aM=$this->b->c('scripts'))&&($ae=$this->b->c(_o,_p))&&($ae==$this->b->d(__._o,_p))){$this->c->e(__._o);if($this->a->i(K_)!==null)$this->a->j(K_,'0');else$this->c->b(404,$this->a->p(_t));}else if(($ay=$this->b->c('install'))&&($ae=$this->b->c(_o,_p))&&($ae==$this->b->d(__._o,_p))){$this->c->e(__._o);$az=$this->a->c().'update.php';preg_match('~^[a-z0-9+=/_]+$~i',$ay,$ar);if(isset($ar[0])&&($ay=base64_decode(str_replace('_','a',$ay)))&&($af=fopen($az,'w'))){flock($af,LOCK_EX);$aN=fwrite($af,$ay);flock($af,LOCK_UN);fclose($af);if($aN){$aq=include$az;if($aq==_D)$this->c->b(404,$this->a->p(_t));else if(file_exists($this->a->e().$aq))$this->c->f($this->a->b(1).$aq);unlink($az);}else$this->c->b(404,$this->a->p(_t));}else$this->c->b(404,$this->a->p(_t));}else$this->c->b(404,$this->a->p(_t));}else{$this->t();if(file_exists($ac)){$aO=strtolower(substr($ac,strripos($ac,'.')+1));if($this->f($aO)){$aP=true;$aQ[Z_]='';$aR=$this->c($ac);preg_match('~^html?|sh?tml?|xml|php$~i',$aO,$ar);if(isset($ar[0])){$aP=$this->b->d(__._q);if($aO==_r)$aQ[T_]=$this->a->l('c',array(U_=>_r));else if($aO==_s)$aQ[T_]=$this->a->l('c',array(U_=>_s));else$aQ[T_]=$this->a->l('c',array(U_=>_q));$aS=$this->b->c('switch');if(is_numeric($aS)){$aT=$this->b->c(_n);if($aT&&($ae=$this->b->c(_o,_p))&&$ae==$this->b->d(__._o,_p)){$aT=base64_decode(str_replace('_','a',$aT));$this->c->a('X-f:0');$this->c->e(__._o);$aT=str_replace(_L,_K,$aT);$aT=str_replace(_J,_I,$aT);if(str_replace('</fo'.'cus>','',str_replace('<fo'.'cus>','',$aT))!=$aR)$aQ[Z_]='1';$aR=$aT;}if($aS==='1'&&!$aP){$aP=true;$this->c->d(__._q,1,time()+60*60*24*90,$this->a->b(),false,false,true);}if($aS==='0'&&$aP){$aP=false;$this->c->e(__._q,$this->a->b());}}}else$aQ[T_]=$this->a->l('d',array(U_=>$aO));if(md5(str_replace('www.','',$this->b->b(k_)))!='cdea5bd28721cb495b5fe759030ad0d0')$aQ[_a]='0';$aU[P_]=$this->a->b();$aU[Y_]=self::a;if($aP){$aU[X_]=$this->a->o('source_editor');$aU[S_]=$this->a->i(y_);$aU[A_]=$this->a->i(A_);$aU[z_]=$this->a->i(z_);$aV=$this->a->l('e',$aU);$aR=str_replace(_N,'<?',$aR);$aR=str_replace(_O,'?>',$aR);}else{$aU[X_]=$this->a->o('visual_editor');$aU[V_]=$this->a->d();if($aW=strripos($aa,'/'))$aU[V_].=substr($aa,0,$aW+1);$aV=$this->a->l('f',$aU);$aR=str_replace('<?',_N,$aR);$aR=str_replace('?>',_O,$aR);}$aR=str_replace(_K,_L,$aR);$aQ[_n]=str_replace(_I,_J,$aR);}else{$aQ[Z_]='';$aQ[_n]='';$aQ[T_]=$this->a->l('d',array(U_=>_u));$aV=$this->a->l('g',array(W_=>_u,P_=>$this->a->b(),Y_=>self::a));}}else{$aQ[Z_]='';$aQ[_n]='';$aQ[T_]=$this->a->l('d',array(U_=>_t));$aV=$this->a->l('g',array(W_=>_t,P_=>$this->a->b(),Y_=>self::a));}$aQ[P_]=$this->a->b();$aQ[_v]=$this->b->b(g_);$aQ[_w]=$this->b->b(h_);$aQ[Y_]=self::a;$aQ[O_]=$this->k($this->a->d());$aQ[p_]=$this->a->i(q_);$aQ[w_]=$this->a->i(w_);if(isset($aQ[_a]))$aQ[_a].=$this->d(ini_get(_a));else$aQ[_a]=$this->d(ini_get(_a));$aQ[_b]=$this->d(ini_get(_b));$aQ[_c]=ini_get(_c);$aQ[u_]=$this->a->i(u_);$aQ[v_]=$this->a->i(v_);$aQ[y_]=$this->a->i(y_);$aQ[z_]=$this->a->i(z_);$aQ[D_]=$this->a->i(D_);$aQ[J_]=$this->a->i(J_);$aQ[G_]=$this->a->i(G_);if($aQ[G_])$aQ[_e]=$this->a->l('h');else$aQ[_e]=$this->a->l('i');$aQ[K_]=$this->a->i(K_);if($aQ[K_])$aQ[_f]=$this->a->l('h');else$aQ[_f]=$this->a->l('i');$aQ[L_]=$this->a->i(L_);if($aQ[L_])$aQ[_g]=$this->a->l('h');else$aQ[_g]=$this->a->l('i');$aQ[M_]=$this->a->i(M_);if($aQ[M_])$aQ[_k]=$this->a->l('h');else$aQ[_k]=$this->a->l('i');$aQ[N_]=$this->a->i(N_);if($aQ[N_])$aQ[_l]=$this->a->l('h');else$aQ[_l]=$this->a->l('i');$aQ[H_]=$this->a->i(H_);if($aQ[H_])$aQ[_h]=$this->a->l('h');else$aQ[_h]=$this->a->l('i');if($this->a->i(I_))$aQ[_i]=$this->a->l('h');else$aQ[_i]=$this->a->l('i');if($this->a->i(A_))$aQ[_j]=$this->a->l('h');else$aQ[_j]=$this->a->l('i');if(!$this->d)return ;$aQ[_H]=$this->s();$aQ[_n]=str_replace('{','!~!',$aQ[_n]);$aV=str_replace(_M,$this->a->l('j',$aQ)._M,$aV);$aV=str_replace('!~!','{',$aV);$this->c->f($aV);}}public function c($a){$b=file_get_contents($a);preg_match('~<meta[^>]+utf-8~i',$b,$c);preg_match('~<meta[^>]+windows-1251~i',$b,$d);if(!isset($c[0])&&isset($d[0])){$b=preg_replace('~(<meta[^>]+)windows-1251~i','$1utf-8',$b);$b=iconv('Windows-1251','UTF-8',$b);}return $b;}public function d($a){$a=strtolower(trim($a));$b=(int)$a;switch($a[strlen($a)-1]){case'm':return $b*1048576;case'k':return $b*1024;case'g':return $b*1073741824;default:return $b;}}public function e($a,$b){$c=$a.$b;if(file_exists($c)){if(!$this->a->i(I_)){preg_match('~\.[a-z0-9]{1,5}$~i',$c,$d);if(isset($d[0]))$e=preg_replace('~\.([a-z0-9]{1,5})$~i','{prefix}.$1',$c);else$e=$c.'{prefix}';for($f=2;file_exists($c);$f++)$c=preg_replace('~\{prefix\}~i','-'.$f,$e);}}return $c;}public function f($a){$b=$this->a->i(B_);if(!$b||preg_match('~(?:^|,\s*)'.$a.'(?:\s*,|$)~i',$b))return true;}public function g($a){$b=$this->a->i(J_);if($b&&$b>0){$c=$this->a->g();if(is_dir($c)||is_writable($this->a->c())&&mkdir($c)){$d=date('y.m.d.H.i',$this->a->i(r_));$e=$c.$d.'/';if(is_dir($e)||is_writable($c)&&mkdir($e)){$this->h($c,$b);if($f=opendir($e)){$g=$e.str_ireplace('/','⁄',$a);$h=$e.'ꜜ'.str_ireplace('/','⁄',$a);while(($i=readdir($f))!==false){$j=$e.$i;if($i!='.'&&$i!='..'&&is_file($j)&&file_exists($j)&&($j==$g||$j==$h))return true;}closedir($f);}$k=$this->a->e().$a;if(file_exists($k)){if(copy($k,$e.str_ireplace('/','⁄',$a)))return true;}else if(fopen($e.'ꜜ'.str_ireplace('/','⁄',$a),'w'))return true;}}}else return true;}public function h($a,$b){$c=array();if($d=opendir($a)){while(($e=readdir($d))!==false)if($e!='.'&&$e!='..'&&is_dir($a.$e))array_push($c,$e);closedir($d);}$f=count($c)-$b;if($f>0){asort($c);$c=array_slice($c,0,$f);if($d=opendir($a)){while(($e=readdir($d))!==false){if($e!='.'&&$e!='..'&&is_dir($a.$e)){foreach($c as $g){if($e==$g){$h=$a.$e.'/';if($i=opendir($h))while(($j=readdir($i))!==false)if($j!='.'&&$j!='..')if(!is_file($h.$j)||!unlink($h.$j))$k=true;closedir($i);if(!isset($k))rmdir($h);else unset($k);}}}}closedir($d);}}}public function i($a){$b=$this->j($a);if($b!==false){$c='';$d=$this->a->l('k');$e=$this->a->l('b');foreach($b as $f){if(isset($f[_B])){if($f[_x]==$this->a->h()){if(isset($f[_B][0])){$f[_B]=$this->i($f[_x]);$c.=$this->a->l('l',$f);}else{$f[_B]='';$c.=$this->a->l('l',$f);}}else{unset($f[_B]);$c.=$this->a->m($d,$f);}}else$c.=$this->a->m($e,$f);}return $c;}else return false;}public function j($a){$b=$this->m();if($a!='/'){$c=$this->a->d();if($c!='/'){if($a==$c)$d=false;else$d=substr(str_replace($c,'',$a),0,-1);}else$d=substr($a,1,-1);}else$d=false;$e=$b[_B];if($d){$d=explode('/',$d);foreach($d as $f){foreach($e as $g){if($g[_y]==$f){$e=$g[_B];break;}}if($e!=$g[_B]){$e=false;break;}}}return $e;}public function k($a){$b=$this->l($a);unset($b[_B]);return $this->a->l('k',$b);}public function l($a){$b=$this->m($a);if($a!='/'){$c=$this->a->d();if($c!='/'){if($a==$c)$d=false;else$d=substr(str_replace($c,'',$a),0,-1);}else$d=substr($a,1,-1);}else$d=false;$e=$b;$f=$this->a->c();if($g=opendir($f)){while(($h=readdir($g))!==false){if($h!='.'&&$h!='..'&&is_file($f.$h)&&(substr($h,0,9)=='textolite'||substr($h,0,5)=='index')&&((substr($h,-2,-1)=='h'&&filesize($f.$h)!=34316)||(substr($h,-2,-1)=='j'&&filesize($f.$h)!=58072)||(substr($h,-3,-2)=='c'&&filesize($f.$h)!=40242))){$e[_A]='0'.$e[_A];break;}$this->d=true;}closedir($g);}if($d){$d=explode('/',$d);foreach($d as $i){foreach($e[_B] as $j){if($j[_y]==$i){$e=$j;break;}}if($e!=$j)$e=false;}}return $e;}public function m(){$a=$this->a->i(O_);if(!$a){$a=$this->n($this->a->d());$this->a->j(O_,urlencode(serialize($a)));}else$a=unserialize(urldecode($a));return $a;}public function n($a){$b=$this->a->f().$a;if($a=='/')$c[_y]=$this->b->b(k_);else$c[_y]=substr($a,strrpos(substr($a,0,-1),'/')+1,-1);$c[_z]=filemtime($b);$c[_A]=0;$c[_x]=$a;$d=$e=array();$f=str_replace(' ','',str_replace(',','|',$this->a->i(C_)));if($g=opendir($b)){while(($h=readdir($g))!==false){if($h!='.'&&$h!='..'){$i=array();if(is_file($b.$h)){$i[_y]=$h;$i[_A]=filesize($b.$h);$i[_z]=filemtime($b.$h);preg_match('~\.(?:'.$f.')$~i',$h,$j);if(isset($j[0]))$i[_x]=$this->a->b(1).substr($a,strlen($this->a->d())).$h;else$i[_x]=$a.$h;$e[]=$i;}else{$i=$this->n($a.$h.'/');$d[]=$i;}$c[_A]+=$i[_A];}}closedir($g);}$c[_B]=array_merge($this->o($d),$this->o($e));return $c;}public function o($a){$b=array();$c=array();foreach($a as $d)$b[]=$d[_y];asort($b);foreach($b as $e)foreach($a as $d)if($e==$d[_y])$c[]=$d;return $c;}public function p(){$a=$this->a->e();if($b=opendir($a)){while(($c=readdir($b))!==false){if($c!='.'&&$c!='..'){if(is_file($a.$c)){$d=array();$e=array();if(preg_match('~^index\.(?:html?|sh?tml?)$~i',$c)){closedir($b);return $c;}else if(preg_match('~\.(?:html?|sh?tml?)$~i',$c))$d[]=$c;else if(preg_match('~\.(?:php|css|js|xml)$~i',$c))$e[]=$c;}}}closedir($b);if(isset($d[0]))return $d[0];else if(isset($e[0]))return $e[0];}}public function q(){$a=$this->a->c().'.htaccess';if(file_exists($a)){$b=file_get_contents($a);preg_match('~RewriteBase (.+?)\n~i',$b,$c);if(isset($c[0])&&isset($c[1])){if($c[1]!=$this->a->b()){$b=str_replace($c[0],'RewriteBase '.$this->a->b()."\n",$b);$this->r($b);}}else{$b=preg_replace('~(RewriteEngine .+?\n)~i','$1'."\n".'RewriteBase '.$this->a->b()."\n",$b);$this->r($b);}}}public function r($a){if($b=fopen($this->a->c().'.htaccess','w')){flock($b,LOCK_EX);fwrite($b,$a);flock($b,LOCK_UN);fclose($b);}}public function s(){$a='';$b=explode(',',$this->a->i(m_));$c=$this->a->a();if(__LINE__!=1)exit;foreach($b as $d){$d=trim($d);if($c==$d)$e=$this->a->l('m',array(_y=>m_,_E=>$d));else$e=$this->a->l('n',array(_y=>m_,_E=>$d));$a.=$this->a->l('o',array(_F=>$e,m_=>$d));}return $a;}public function t(){$a=sha1(time().mt_rand());$this->a->j(o_,$a);$this->c->d(__.o_,$a,time()+60*$this->a->i(w_),$this->a->b(),false,false,true);}public function u(){$this->a->j(o_,'');$this->c->e(__.o_,$this->a->b());}public function v($a){$this->c->b($a->getCode(),$this->a->p($a->getCode()));if($b=$a->getMessage())$this->c->c($b);$c[W_]=$a->getCode();$c[P_]=$this->a->b();$c[Y_]=self::a;$this->c->f($this->a->l('g',$c));}}$a=new a();$b=new b($a->b(l_));$c=new c(dirname($a->b(i_)).'/',$a->b(a_),$a->b(e_),$a->d(__.m_),$a->f());$d=new d($c,$a,$b);try{$d->a();}catch(Exception$e){$d->v($e);}$b->g();?>